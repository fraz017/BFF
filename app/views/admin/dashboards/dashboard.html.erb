<div class="content-wrapper">
  <!-- Content Header (Page header) -->
  <section class="content-header">
    <h1>
      Dashboard
      <small>Preview</small>
    </h1>
  </section>

  <!-- Main content -->
  <section class="content">
    <div class="row">
      <div class="col-xs-6">
        <div class="box">
          <div class="box-header">
            <h3 class="box-title">Responsive Hover Table</h3>
          </div><!-- /.box-header -->
          <div class="box-body table-responsive no-padding user-table">
            <table class="table table-hover">
              <tr>
                <th>ID</th>
                <th>Email</th>
                <th>Status</th>
                <th>View Profile</th>
              </tr>
              <% @users.each do |user| %>
                <tr>
                  <td><%= user.id %></td>
                  <td><%= user.email %></td>
                  <td>
                    <span class="users-<%= user.id %>-online <%= user.is_online? == true ? '' : 'hidden' %> label label-success">Online</span>
                    <span class="users-<%= user.id %>-offline <%= user.is_online? == false ? '' : 'hidden' %> label label-danger">Offline</span>
                  </td>
                  <td>
                    <%= link_to "View Profile", admin_path(user), {:remote => true, 'data-toggle' =>  "modal", 'data-target' => '#profileModal', :class => "btn btn-sm btn-primary"} %>
                  </td>
                </tr>
              <% end %>
              <tr>
                <td colspan="4" class="text-center"><%= will_paginate @users, renderer: BootstrapPagination::Rails %></td>
              </tr>
            </table>
          </div><!-- /.box-body -->
        </div><!-- /.box -->
      </div>
      <div class="col-xs-6">
        <!-- Box Comment -->
        <div class="box box-widget">
          <div class='box-header with-border'>
            <div class='user-block'>  
              <h2>BFF Logs</h2>
            </div><!-- /.user-block -->
          </div><!-- /.box-header -->
          <div class='box-footer box-comments log-comments'>
            <% @logs.each do |log| %>
              <div class="panel-group">
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title">
                      <a data-toggle="collapse" href="#log_<%= log.id %>">
                        <div>
                          <span><%= log.sender.email %></span>
                          <span class='text-muted pull-right'><%= log.created_at.strftime("%d %b %l:%M %P ") %></span>
                        </div>
                        <span><%= log.content %></span>  
                      </a>
                    </h4>
                  </div>
                  <div id="log_<%= log.id %>" class="panel-collapse collapse">
                    <div class="panel-body">
                      <%= get_replies(log.message_id) %>  
                    </div>
                  </div>
                </div>
              </div>
            <%end%>
          </div><!-- /.box-footer -->
        </div><!-- /.box -->
      </div><!-- /.col -->
    </div><!-- /.row -->
<!-- Modal -->
  </section>
</div>  

<div id="profileModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title"><i class="fa fa-user margin-r-5"></i>User Profile</h4>
      </div>
      <div class="modal-body">
        <div class="user-profile">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

<style type="text/css">
  .box-widget{
    min-height: 600px;
    max-height: 600px;
    height: 600px;
    overflow: auto;
  }
  .user-table{
    max-height: 560px;
    min-height: 560px;
    height: 560px;
    overflow: auto;
  }
</style>

<script type="text/javascript">
  $(".box-widget").animate({ scrollTop: $(".box-widget")[0].scrollHeight}, 1000);
</script>